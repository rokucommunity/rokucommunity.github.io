---
date: April 2023
summary: Changes to vscode-brightscript-language, brighterscript, roku-deploy, roku-debug, brighterscript-formatter, bslint, ropm, roku-report-analyzer
layout: ../../layouts/WhatsNewPost.astro
---
# Overview

This month (April 2003) we have seen a number of improvements across VSCode including

- Improved sideloading speed by excluding sourcemaps
- Improving stability of RALE 
- Improving debug session notifications 
- Improving BSLinting including no longer consider `const` as an unused variable 
- Improved use of namespaces and enums in Brighterscript
- Added the ability to create .cpuprofile files when performance benchmarking 
- Ensure the GitHub build badge is correctly reporting the build status 
- Improvements to automation including finding nodes by location 
- Improve DNS lookup failover when the primary lookup fails

Many thanks to our regular and willing contributors, without whom this would not be possible!

VSCode Brightscript team!

# Editor

# Debugging

## Exclude sourcemaps when sideloading
Many preprocessors such as BrighterScript or gulp plugins will generate sourcemaps alongside the generated files, which are a way to link a generated file, line, and column location back to its original location. The BrightScript language extension for VSCode fully supports reading these sourcemaps to improve the debugging experience with projects that leverage a preprocessor. However, sourcemaps are fairly large, sometimes even as large as the generated file itself. 

![image](https://github.com/rokucommunity/rokucommunity.github.io/assets/2544493/c5a172a3-fec3-4035-9ae3-669a43858298)

Also, it seems that on-Roku compile times are slower anytiime sourcemaps are present (perhaps they try to parse them?), which results in measurably longer on-device compile times. 

Thanks to [roku-debug#145](https://github.com/RokuCommunity/roku-debug/pull/145), the BrightScript Language extension for VSCode will now exclude sourceamps from sideloaded zips starting in [v2.40.0](https://github.com/rokucommunity/vscode-brightscript-language/compare/v2.39.0...v2.40.0) . This speeds up zip times, upload times, _and_ compile times. Here are some timing results from a large brighterscript app. The results speak for themselves:

**Sourcemaps INCLUDED:**

```
Packaging projects took: 3s180ms, Uploading zip took 7731ms, AppCompileComplete --------> Duration(5565ms)
Packaging projects took: 2s912ms, Uploading zip took 7118ms, AppCompileComplete --------> Duration(5467ms)
Packaging projects took: 2s907ms, Uploading zip took 7072ms, AppCompileComplete --------> Duration(5681ms)
```

**Sourcemaps EXCLUDED:**

```
Packaging projects took: 2s331ms, Uploading zip took 5927ms, AppCompileComplete --------> Duration(4143ms)
Packaging projects took: 2s305ms, Uploading zip took 5899ms, AppCompileComplete --------> Duration(3959ms)
Packaging projects took: 2s411ms, Uploading zip took 5920ms, AppCompileComplete --------> Duration(3972ms)
```

## Better error handling for RALE integration
If you aren't aware, the vscode extension has some basic support for [RALE integration](https://rokucommunity.github.io/vscode-brightscript-language/Debugging/rale.html). When enabled, the extension can auto-inject the RALE tracker task init code into your project by replacing a specific comment with the tracker task init logic. However, there was a bug where the debug session would crash with a very obscure message if `injectRaleTrackerTask` was enabled but the file at `raleTrackerTaskFileLocation` was missing or the property was omitted entirely. 

As of vscode extension [v2.40.0](https://github.com/rokucommunity/vscode-brightscript-language/compare/v2.39.0...v2.40.0), this flow has been improved to now show a much more helpful error notification. 

![image](https://github.com/rokucommunity/vscode-brightscript-language/assets/2544493/414beed6-54d5-4556-9120-19a664c9d083)

## Better error reporting for launch.json validation crashes
At the start of a debug session in VSCode, our BrightScript Language extension will validate and sanitize the selected launch.json configuration. Sometimes we encounter a runtime exception in this process. In the past, we weren't properly exposing those issues to the developer. As of vscode extension [v2.40.0](https://github.com/rokucommunity/vscode-brightscript-language/compare/v2.39.0...v2.40.0), we've also properly wrapped the entire launch config processing block in a try/catch so we can log exceptions to the output channel, which should help developers get more useful feedback for future crashes. 

![image](https://github.com/rokucommunity/vscode-brightscript-language/assets/2544493/bd6fcaae-cf7e-4cff-b07d-de53196ca266)


## Add better error for failed session starts
If you've been using the vscode extension for a while now, you've probably encountered situations where the debug session just randomly shuts down, with no warning or explanation. Starting in release [v2.40.1](https://github.com/rokucommunity/vscode-brightscript-language/blob/master/CHANGELOG.md#2401---2023-04-28), many of these crashes will now show a much more helpful error popup. 

# BrighterScript
## bslint now works with `const`
If you've used the `const` feature in BrighterScript (introduced in [v0.53.0](https://github.com/rokucommunity/brighterscript/blob/master/CHANGELOG.md#0530---2022-07-14)) and also [bslint](https://github.com/rokucommunity/bslint), you may have noticed that bslint would incorrectly show errors whenever you tried to reference those consts. 

![image](https://github.com/rokucommunity/brighterscript/assets/2544493/c63000da-3316-400a-aebf-bf0bc3484f63)

This has been fixed and is available starting in [bslint v0.8.3](https://github.com/rokucommunity/bslint/blob/master/CHANGELOG.md#083---2023-04-18)

![image](https://github.com/rokucommunity/brighterscript/assets/2544493/bcd949c0-1b09-4552-b42b-6dd612e55a31)

## Fix namespace-relative items
BrighterScript has a feature in nested namespaces where all the items in that same namespace can be referenced _without_ needing to include the full leading namespace part. We refer to this as "namespace inference", which you can read about [here](https://github.com/rokucommunity/brighterscript/blob/master/docs/namespaces.md#namespace-inference). As a result of supporting this feature, certain names become unavailable for use as variable identifiers when they conflict with inferred namespace names. These variables are now properly flagged as errors starting in BrighterScript [v0.64.0](https://github.com/rokucommunity/brighterscript/blob/master/CHANGELOG.md#0640---2023-04-04). 

## Fix semantic tokens for namespaces
Semantic tokens are a way for the language server to improve syntax highlighting for certain tokens, based on compile-time semantics that simple textmate grammar syntax highlighting can't support. 

BrighterScript now catches when namespaces are used like variables, and we've fixed some semantic colorization issues: 
- validation for using namespaces in assignment statements and function parameters
- semantic tokens for namespaces in assignment statements
- semantic tokens for namespaces as function parameters
- enum member lookups are now case INsensitive


## Fix namespace-relative enum value ([#793](https://github.com/RokuCommunity/brighterscript/pull/793))

- Fixes a bug that was incorrectly flagging namespace-relative enum values.

## Improves performance in symbol table fetching ([#797](https://github.com/RokuCommunity/brighterscript/pull/797))

- Small performance boost by optimizing the AstNode.getSymbolTable() method.

Before:

![image](https://user-images.githubusercontent.com/2544493/233732854-1577e2c5-e2eb-489b-b49e-9c5464b97e04.png)

After: 

![image](https://user-images.githubusercontent.com/2544493/233732843-42f08221-45de-49ea-99b7-1707567ac1f8.png)

## Add cpuprofile ability to the benchmarks ([#796](https://github.com/RokuCommunity/brighterscript/pull/796))

- Adds ability to generate .cpuprofile files when running benchmarks.
- Don't delete installed bsc versions after test (for benchmarking results)

## Fix benchmark crashes ([#795](https://github.com/RokuCommunity/brighterscript/pull/795))
 
- Fixes stability issues in the benchmark project


# GitHub workflow 

## Fix build badge ([#474](https://github.com/RokuCommunity/vscode-brightscript-language/pull/474) and https://github.com/RokuCommunity/roku-deploy/commit/ad2c9ec)

- Fixes an issue with the GitHub build status badge icon is incorrectly reporting 'passing' or 'failing' and thus cannot be relied upon.
- One can now click to view the workflow results at build.yml

<img src="../../../public/images/screenshots/github-build-badge.png" />

# Unit Testing 

## Fix wsl rdb bugs ([#478](https://github.com/RokuCommunity/vscode-brightscript-language/pull/478))

# Automation

## Switched to finding nodes at a given location (x,y) in webview directly ([#477](https://github.com/RokuCommunity/vscode-brightscript-language/pull/477))



## Switched from ChromeClose icon to ArrowLeft icon to avoid confusion when closing detail page ([#477](https://github.com/RokuCommunity/vscode-brightscript-language/pull/477))

**From:**

<img src="https://www.svgrepo.com/show/361066/chrome-close.svg" width="50" />

**To:**

<img src="https://cdn-icons-png.flaticon.com/512/109/109618.png" width="50" />

# Networking

## Wrap the dnsLookup for host in a try/catch ([#473](https://github.com/RokuCommunity/vscode-brightscript-language/pull/473))

- Wrap the dnsLookup in the BrightScriptCommands file in a try/catch, so even if the dns lookup fails, it will still at least try to use what we have.



# Thank you

Last but certainly not least, a big ***Thank You*** to the following people who contributed this month:

Contributions to [vscode-brightscript-language](https://github.com/RokuCommunity/vscode-brightscript-language):
 - [@triwav (Brian Leighty)](https://github.com/triwav)
    - Run find node calculations in webview and other improvements ([PR #477](https://github.com/RokuCommunity/vscode-brightscript-language/pull/477))
 - [@TwitchBronBron (Bronley Plumb)](https://github.com/TwitchBronBron)
    - Fix crash during launch due to missing rale option ([PR #476](https://github.com/RokuCommunity/vscode-brightscript-language/pull/476))
    - Wrap the dnsLookup for host in a try/catch ([PR #473](https://github.com/RokuCommunity/vscode-brightscript-language/pull/473))
    - Fix small lint issues ([PR #479](https://github.com/RokuCommunity/vscode-brightscript-language/pull/479))
    - Fix wsl rdb bugs ([PR #478](https://github.com/RokuCommunity/vscode-brightscript-language/pull/478))
 - [@cewert (Charles Ewert)](https://github.com/cewert)
    - Fix build badge ([PR #474](https://github.com/RokuCommunity/vscode-brightscript-language/pull/474))
 - [@jean-guyrivard (Jean-Guy Rivard)](https://github.com/jean-guyrivard)
    - Added validation for raleTrackerTaskFileLocation setting existence. ([PR #472](https://github.com/RokuCommunity/vscode-brightscript-language/pull/472))

Contributions to [brighterscript](https://github.com/RokuCommunity/brighterscript):
 - [@TwitchBronBron (Bronley Plumb)](https://github.com/TwitchBronBron)
    - Fix namespace-relative items ([PR #789](https://github.com/RokuCommunity/brighterscript/pull/789))
    - Fix namespace-relative enum value ([PR #793](https://github.com/RokuCommunity/brighterscript/pull/793))
    - Improves performance in symbol table fetching ([PR #797](https://github.com/RokuCommunity/brighterscript/pull/797))
    - Add cpuprofile ability to the benchmarks ([PR #796](https://github.com/RokuCommunity/brighterscript/pull/796))
    - Fix benchmark crashes ([PR #795](https://github.com/RokuCommunity/brighterscript/pull/795))
 
Contributions to [roku-deploy](https://github.com/RokuCommunity/roku-deploy):
 - [@TwitchBronBron (Bronley Plumb)](https://github.com/TwitchBronBron)
    - Fix build status badge ([ad2c9ec](https://github.com/RokuCommunity/roku-deploy/commit/ad2c9ec))

Contributions to [roku-debug](https://github.com/RokuCommunity/roku-debug):
 - [@TwitchBronBron (Bronley Plumb)](https://github.com/TwitchBronBron)
    - Exclude sourcemaps when sideloading ([PR #145](https://github.com/RokuCommunity/roku-debug/pull/145))
    - Add better error for failed session starts ([PR #147](https://github.com/RokuCommunity/roku-debug/pull/147))
    - Make axios a prod dependency ([PR #148](https://github.com/RokuCommunity/roku-debug/pull/148))
 - [@sethmaclean (sethmaclean)](https://github.com/sethmaclean)
    - adds device query info to debug session ([PR #130](https://github.com/RokuCommunity/roku-debug/pull/130))

Contributions to [brighterscript-formatter](https://github.com/RokuCommunity/brighterscript-formatter):

Contributions to [bslint](https://github.com/RokuCommunity/bslint):
 - [@taschmidt (Tim Schmidt)](https://github.com/taschmidt)
    - fix: do not consider consts as unused variables ([PR #85](https://github.com/RokuCommunity/bslint/pull/85))

Contributions to [ropm](https://github.com/RokuCommunity/ropm):

Contributions to [roku-report-analyzer](https://github.com/RokuCommunity/roku-report-analyzer):
